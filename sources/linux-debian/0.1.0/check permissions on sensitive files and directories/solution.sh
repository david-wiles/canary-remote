#!/bin/bash


filenames=(
	"/root"
	"/etc/issue"
	"/etc/*-release"
	"/etc/lsb-release"
	"/etc/redhat-release"
	"/proc/version"
	"/proc"
	"/etc/profile"
	"/etc/bashrc"
	"/etc/passwd"
	"/etc/group"
	"/etc/shadow"
	"/var/mail/"
	"/etc/ssh"
	"/etc/ssh/ssh_config"
	"/etc/ssh/sshd_config"
	"/etc/ssh/ssh_host_dsa_key.pub"
	"/etc/ssh/ssh_host_dsa_key"
	"/etc/ssh/ssh_host_rsa_key.pub"
	"/etc/ssh/ssh_host_rsa_key"
	"/etc/ssh/ssh_host_key.pub"
	"/etc/ssh/ssh_host_key"
	"/etc/syslog.conf"
	"/etc/chttp.conf"
	"/etc/lighttpd.conf"
	"/etc/cups/cupsd.conf"
	"/etc/inetd.conf"
	"/etc/apache2/apache2.conf"
	"/etc/my.conf"
	"/etc/httpd/conf/httpd.conf"
	"/opt/lampp/etc/httpd.conf"
	"/var/apache2/config.inc"
	"/var/lib/mysql/mysql/user.MYD"
	"/root/anaconda-ks.cfg"
	"/var/log"
	"/var/mail"
	"/var/spool"
	"/var/spool/lpd"
	"/var/lib/pgsql"
	"/var/lib/mysql"
	"/etc/cron*"
	"/etc/at.allow"
	"/etc/at.deny"
	"/etc/cron.allow"
	"/etc/cron.deny"
	"/etc/crontab"
	"/etc/anacrontab"
	"/var/spool/cron/crontabs/root"
	"/etc/network/interfaces"
	"/etc/sysconfig/network"
	"/etc/resolv.conf"
	"/etc/sysconfig/network"
	"/etc/networks"
	"/etc/httpd/logs/access_log"
	"/etc/httpd/logs/access.log"
	"/etc/httpd/logs/error_log"
	"/etc/httpd/logs/error.log"
	"/var/log/apache2/access_log"
	"/var/log/apache2/access.log"
	"/var/log/apache2/error_log"
	"/var/log/apache2/error.log"
	"/var/log/apache/access_log"
	"/var/log/apache/access.log"
	"/var/log/auth.log"
	"/var/log/chttp.log"
	"/var/log/cups/error_log"
	"/var/log/dpkg.log"
	"/var/log/faillog"
	"/var/log/httpd/access_log"
	"/var/log/httpd/access.log"
	"/var/log/httpd/error_log"
	"/var/log/httpd/error.log"
	"/var/log/lastlog"
	"/var/log/lighttpd/access.log"
	"/var/log/lighttpd/error.log"
	"/var/log/lighttpd/lighttpd.access.log"
	"/var/log/lighttpd/lighttpd.error.log"
	"/var/log/messages"
	"/var/log/secure"
	"/var/log/syslog"
	"/var/log/wtmp"
	"/var/log/xferlog"
	"/var/log/yum.log"
	"/var/run/utmp"
	"/var/webmin/miniserv.log"
	"/var/www/logs/access_log"
	"/var/www/logs/access.log"
	"/var/lib/dhcp3/"
	"/var/log/postgresql/"
	"/var/log/proftpd/"
	"/var/log/samba/"
	"/etc/docker"
	"/etc/docker/daemon.json")

for filename in ${filenames[@]}; do
  if [[ -d "$filename" || -f "$filename" ]]; then
    if [ $(stat -c %a $filename | grep -E '.*[^0]$' | wc -l) -ne 0 ]; then
      sudo chmod o-rwx $filename
    fi
  fi
done
